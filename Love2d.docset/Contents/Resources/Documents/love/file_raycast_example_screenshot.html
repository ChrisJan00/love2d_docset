<html class="client-nojs" dir="ltr" lang="en">
  <head>
    <meta charset="UTF-8"/>
    <title>File:raycast example screenshot.png - LOVE</title>
    <meta content="MediaWiki 1.24.2" name="generator"/>
    <link href="" rel="ExportRDF" title="File:raycast example screenshot.png" type="application/rdf+xml"/>
    <link href="favicon.ico" rel="shortcut icon"/>
    <link href="opensearch_desc.php" rel="search" title="LOVE (en)" type="application/opensearchdescription+xml"/>
    <link href="api.php_action_rsd" rel="EditURI" type="application/rsd+xml"/>
    <link href="" hreflang="x-default" rel="alternate"/>
    <link href="http://www.gnu.org/copyleft/fdl.html" rel="copyright"/>
    <link href="" rel="alternate" title="LOVE Atom feed" type="application/atom+xml"/>
    <link href="love_wiki_style.css" rel="stylesheet"/>
    <meta content="" name="ResourceLoaderDynamicStyles"/>
    <style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: love2d_wiki:resourceloader:filter:minify-css:7:daf253d59690fd9cabb6b95510bce103 */</style>
  </head>
  <body class="mediawiki ltr sitedir-ltr ns-6 ns-subject page-File_raycast_example_screenshot_png skin-love action-view">
    <div id="globalWrapper">
      <div id="column-content">
        <div class="mw-body" id="content" role="main">
          <h1 class="firstHeading" id="firstHeading" lang="en">File:raycast example screenshot.png</h1>
          <div id="bodyContent">
            <div id="mw-content-text">
              <ul id="filetoc"/>
              <div class="fullImageLink" id="file">
                <div class="mw-filepage-resolutioninfo">No higher resolution available.</div>
                <img alt="File:raycast example screenshot.png" height="600" src="raycast_example_screenshot.png" width="800"/>
              </div>
              <div class="fullMedia"><a class="internal" href="raycast_example_screenshot.png" title="raycast example screenshot.png">raycast_example_screenshot.png</a> &#x200E;<span class="fileInfo">(800 &#xD7; 600 pixels, file size: 9 KB, MIME type: image/png)</span>
</div>
              <div class="mw-content-ltr" dir="ltr" id="mw-imagepage-content" lang="en">
                <p>A screenshot of a <a href="fixture_raycast.html" title="Fixture:rayCast">Fixture:rayCast</a> example for L&#xD6;VE <a href="0.8.html" title="0.8.0">0.8.0</a>.
</p>
                <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                  <div class="lua source-lua">
                    <pre class="de1"><span class="kw1">function</span> love<span class="sy0">.</span>load<span class="br0">(</span><span class="br0">)</span>
	<span class="co1">-- Setting this to 1 to avoid all current scaling bugs.</span>
	love<span class="sy0">.</span>physics<span class="sy0">.</span>setMeter<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>
&#xA0;
	World <span class="sy0">=</span> love<span class="sy0">.</span>physics<span class="sy0">.</span>newWorld<span class="br0">(</span><span class="br0">)</span>
&#xA0;
	Box <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
	Box<span class="sy0">.</span>Body <span class="sy0">=</span> love<span class="sy0">.</span>physics<span class="sy0">.</span>newBody<span class="br0">(</span>World<span class="sy0">,</span> <span class="nu0">400</span><span class="sy0">,</span> <span class="nu0">300</span><span class="sy0">,</span> <span class="st0">"dynamic"</span><span class="br0">)</span>
	Box<span class="sy0">.</span>Shape <span class="sy0">=</span> love<span class="sy0">.</span>physics<span class="sy0">.</span>newRectangleShape<span class="br0">(</span><span class="nu0">150</span><span class="sy0">,</span> <span class="nu0">150</span><span class="br0">)</span>
	Box<span class="sy0">.</span>Fixture <span class="sy0">=</span> love<span class="sy0">.</span>physics<span class="sy0">.</span>newFixture<span class="br0">(</span>Box<span class="sy0">.</span>Body<span class="sy0">,</span> Box<span class="sy0">.</span>Shape<span class="br0">)</span>
&#xA0;
	<span class="co1">-- Giving the box a gentle spin.</span>
	Box<span class="sy0">.</span>Body<span class="sy0">:</span>setAngularVelocity<span class="br0">(</span><span class="nu0">0.5</span><span class="br0">)</span>
&#xA0;
	Ray1 <span class="sy0">=</span> <span class="br0">{</span>
		point1 <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span><span class="sy0">,</span>
		point2 <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span><span class="sy0">,</span>
	<span class="br0">}</span>
	Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">=</span> <span class="nu0">50</span><span class="sy0">,</span> <span class="nu0">50</span>
	Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>y <span class="sy0">=</span> <span class="nu0">400</span><span class="sy0">,</span> <span class="nu0">300</span>
	Ray1<span class="sy0">.</span>scale <span class="sy0">=</span> <span class="nu0">1</span>
&#xA0;
	Ray2 <span class="sy0">=</span> <span class="br0">{</span>
		point1 <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span><span class="sy0">,</span>
		point2 <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span><span class="sy0">,</span>
	<span class="br0">}</span>
	Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">=</span> <span class="nu0">500</span><span class="sy0">,</span> <span class="nu0">400</span>
	Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>y <span class="sy0">=</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x <span class="sy0">+</span> <span class="kw3">math.cos</span><span class="br0">(</span><span class="kw3">math.pi</span><span class="sy0">*</span><span class="nu0">1.45</span><span class="br0">)</span><span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">+</span> <span class="kw3">math.sin</span><span class="br0">(</span><span class="kw3">math.pi</span><span class="sy0">*</span><span class="nu0">1.45</span><span class="br0">)</span>
	Ray2<span class="sy0">.</span>scale <span class="sy0">=</span> <span class="nu0">150</span>
<span class="kw1">end</span>
&#xA0;
<span class="kw1">function</span> love<span class="sy0">.</span>update<span class="br0">(</span>dt<span class="br0">)</span>
	World<span class="sy0">:</span>update<span class="br0">(</span>dt<span class="br0">)</span>
<span class="kw1">end</span>
&#xA0;
<span class="kw1">function</span> love<span class="sy0">.</span>draw<span class="br0">(</span><span class="br0">)</span>
	<span class="co1">-- Drawing the box.</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">255</span><span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>polygon<span class="br0">(</span><span class="st0">"line"</span><span class="sy0">,</span> Box<span class="sy0">.</span>Body<span class="sy0">:</span>getWorldPoints<span class="br0">(</span> Box<span class="sy0">.</span>Shape<span class="sy0">:</span>getPoints<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span><span class="br0">)</span>
&#xA0;
	<span class="co1">-- Drawing the input lines of the rays and the reach of ray 2 in gray.</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>setLineWidth<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">50</span><span class="sy0">,</span> <span class="nu0">50</span><span class="sy0">,</span> <span class="nu0">50</span><span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x <span class="sy0">+</span> <span class="br0">(</span>Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>x <span class="sy0">-</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="br0">)</span> <span class="sy0">*</span> Ray2<span class="sy0">.</span>scale<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">+</span> <span class="br0">(</span>Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>y <span class="sy0">-</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="br0">)</span> <span class="sy0">*</span> Ray2<span class="sy0">.</span>scale<span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">255</span><span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>y<span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>y<span class="br0">)</span>
	love<span class="sy0">.</span>graphics<span class="sy0">.</span>setLineWidth<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>
&#xA0;
	<span class="co1">-- Remember that the ray cast can return nil if it hits nothing.</span>
	<span class="kw1">local</span> r1nx<span class="sy0">,</span> r1ny<span class="sy0">,</span> r1f <span class="sy0">=</span> Box<span class="sy0">.</span>Fixture<span class="sy0">:</span>rayCast<span class="br0">(</span>Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>y<span class="sy0">,</span> Ray1<span class="sy0">.</span>scale<span class="br0">)</span>
	<span class="kw1">local</span> r2nx<span class="sy0">,</span> r2ny<span class="sy0">,</span> r2f <span class="sy0">=</span> Box<span class="sy0">.</span>Fixture<span class="sy0">:</span>rayCast<span class="br0">(</span>Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>y<span class="sy0">,</span> Ray2<span class="sy0">.</span>scale<span class="br0">)</span>
&#xA0;
	<span class="kw1">if</span> r1nx <span class="kw1">then</span>
		<span class="co1">-- Calculating the world position where the ray hit.</span>
		<span class="kw1">local</span> r1HitX <span class="sy0">=</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x <span class="sy0">+</span> <span class="br0">(</span>Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>x <span class="sy0">-</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="br0">)</span> <span class="sy0">*</span> r1f
		<span class="kw1">local</span> r1HitY <span class="sy0">=</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">+</span> <span class="br0">(</span>Ray1<span class="sy0">.</span>point2<span class="sy0">.</span>y <span class="sy0">-</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="br0">)</span> <span class="sy0">*</span> r1f
&#xA0;
		<span class="co1">-- Drawing the ray from the starting point to the position on the shape.</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">)</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray1<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> r1HitX<span class="sy0">,</span> r1HitY<span class="br0">)</span>
&#xA0;
		<span class="co1">-- We also get the surface normal of the edge the ray hit. Here drawn in green</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">)</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>r1HitX<span class="sy0">,</span> r1HitY<span class="sy0">,</span> r1HitX <span class="sy0">+</span> r1nx <span class="sy0">*</span> <span class="nu0">25</span><span class="sy0">,</span> r1HitY <span class="sy0">+</span> r1ny <span class="sy0">*</span> <span class="nu0">25</span><span class="br0">)</span>
	<span class="kw1">end</span>
&#xA0;
	<span class="kw1">if</span> r2nx <span class="kw1">then</span>
		<span class="co1">-- Calculating the world position where the ray hit.</span>
		<span class="kw1">local</span> r2HitX <span class="sy0">=</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x <span class="sy0">+</span> <span class="br0">(</span>Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>x <span class="sy0">-</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="br0">)</span> <span class="sy0">*</span> r2f
		<span class="kw1">local</span> r2HitY <span class="sy0">=</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y <span class="sy0">+</span> <span class="br0">(</span>Ray2<span class="sy0">.</span>point2<span class="sy0">.</span>y <span class="sy0">-</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="br0">)</span> <span class="sy0">*</span> r2f
&#xA0;
		<span class="co1">-- Drawing the ray from the starting point to the position on the shape.</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">)</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>x<span class="sy0">,</span> Ray2<span class="sy0">.</span>point1<span class="sy0">.</span>y<span class="sy0">,</span> r2HitX<span class="sy0">,</span> r2HitY<span class="br0">)</span>
&#xA0;
		<span class="co1">-- We also get the surface normal of the edge the ray hit. Here drawn in green</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>setColor<span class="br0">(</span><span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">)</span>
		love<span class="sy0">.</span>graphics<span class="sy0">.</span>line<span class="br0">(</span>r2HitX<span class="sy0">,</span> r2HitY<span class="sy0">,</span> r2HitX <span class="sy0">+</span> r2nx <span class="sy0">*</span> <span class="nu0">25</span><span class="sy0">,</span> r2HitY <span class="sy0">+</span> r2ny <span class="sy0">*</span> <span class="nu0">25</span><span class="br0">)</span>
	<span class="kw1">end</span>
<span class="kw1">end</span></pre>
                  </div>
                </div>
              </div>
              <h2 id="filehistory">File history</h2>
              <div id="mw-imagepage-section-filehistory">
                <p>Click on a date/time to view the file as it appeared at that time.
</p>
                <table class="wikitable filehistory">
                  <tr>
                    <td/>
                    <th>Date/Time</th>
                    <th>Thumbnail</th>
                    <th>Dimensions</th>
                    <th>User</th>
                    <th>Comment</th>
                  </tr>
                </table>
              </div>
              <ul>
                <li id="mw-imagepage-upload-disallowed">You cannot overwrite this file.</li>
              </ul>
              <h2 id="filelinks">File usage</h2>
              <div id="mw-imagepage-section-linkstoimage">
                <p>The following 2 pages link to this file:
</p>
                <ul class="mw-imagepage-linkstoimage">
                  <li class="mw-imagepage-linkstoimage-ns0">
                    <a href="fixture_raycast.html" title="Fixture:rayCast">Fixture:rayCast</a>
                  </li>
                  <li class="mw-imagepage-linkstoimage-ns0">
                    <a href="shape_raycast.html" title="Shape:rayCast">Shape:rayCast</a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="catlinks catlinks-allhidden" id="catlinks"/>
            <div class="visualClear"/>
          </div>
        </div>
      </div>
      <div class="visualClear"/>
      <div id="footer" role="contentinfo">
        <ul id="f-list">
          <li id="copyright">Content is available under <a class="external" href="http://www.gnu.org/copyleft/fdl.html" rel="nofollow">GNU Free Documentation License 1.3</a> unless otherwise noted.</li>
        </ul>
      </div>
    </div>
  </body>
</html>
